<html lang="ja">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<style type="text/css">
   body { line-height: 1.5; }
</style>
<head>
<title> Conograph CUI プログラムの操作説明書 </title>
</head>
<body lang="ja">
<font size="+1"><b> Conograph CUI プログラムの操作説明書 </b></font><br>
<font size="-1" color="#339999"> [<a href="InstructionsConograph.html">English</a> / Japanese] </font><br>

<p>
<font size="-1" color="#CC0000"> Conograph GUI テストバージョンの配布を<a href="http://research.kek.jp/people/rtomi/ConographGUI/web_page_JP.html">こちら</a>より開始しました(4/26/2013)。</font>
</p>
<p>
以下では、オープンソースの粉末指数づけプログラム Conogaph CUI Version 0.99（<a href="http://sourceforge.jp/projects/conograph/releases/">download page</a>@sourceforge.jp）について簡単に説明します。<BR>
Conograph GUI は現在開発中です (2013/3/2)。
Conograph は粉末指数づけの新しい数学的手法を採用しており、現時点でその手法を紹介している文献に、[<a href="#ref2">2</a>]と[<a href="#ref3">3</a>]があります。
</p>

<DIV style="text-align:left;">
 <DIV style="text-align:right;float:right;">
<table border="0" cellpadding="0">
  <tr>
	<td style="width: 400px; height: 210px; text-align: center;">
<div align="center">
   <p class="image"><img src="figures/outline_JP.png" width="348" height="169" alt="Figure 2" border="0"></p>
   <p class="caption ">図 1: Conograph による粉末指数づけの３つの主要ステージ</p>
</div>
        </td>
  </tr>
</table>
 </DIV>
<p>
Conograph は中性子飛行時間法を含む任意の粉末回折データに対し、比較的短時間で解の徹底探索を行うことができます。
ピークサーチ実行後に行われる粉末指数づけは、図1の3つのステージに大別することができます。
Conograph は全てのブラベー格子、空間群、消滅則に共通する解の列挙手法を採用しているため、ブラベー格子決定が必要になります。
得られた格子定数は入力されたピーク位置の観測誤差から波及する誤差をある程度含むため、
誤差に安定なブラベー格子決定手法を新たに開発しました [<a href="#ref3">3</a>]。
</p>

<p>
メモリ使用量優先探索 (regular search) を選択した場合、Conograph が準備している探索パラメータから特に大きな変更が行われなければ、全てのステージの実行は約10分程度で終了します。
速さ優先探索 (quick search) では、約5分以内に全ての処理が終了します。
(ただし、i7 CPU (3.2 GHz, 8スレッド)を使用した結果で、ご使用のパソコンによってはもっと時間がかかる場合があります。)
</p>

<p>
初めて Conograph を使用する際は、難しいケースでも入力する探索パラメータの変更の必要がほとんどない「メモリ使用量優先探索」を選択することをお勧めしています。ただし、「速さ優先探索」でも、ユニットセルが小さいまたは対称性が高いといった簡単なケースでは、
入力パラメータの変更が必要ないことが多いです。
「速さ優先探索」と「メモリ使用量優先探索」の違いは、<a href="doc/TipsForPowderAutoIndexing_JP.html#DifferenceTwoSearches">ここ</a>でもう少し詳しく説明しています。
</p>

</DIV>


<h2>NEWS</h2>
<dl>
  <dt>2016/9/7</dt>
  <dd>
<ul>
<li> 底心格子に関する出力形式に関する誤りを訂正しました。
</ul>
  </dd>
</dl>


<h2>FAQ</h2>
<ul>
    <li><a href="#HowtoUse">Conograph CUI の使い方</a></li>
    <ul>
        <li><a href="#StartUpConograph">Conograph を実行する</a></li>
        <li><a href="#AfterExecution">実行後に格子定数とゼロ点シフトを精密化する</a></li>
    </ul>
    <li><a href="#TipsForPeakSearch">ピークサーチに関するアドバイス</a> 
    <li><a href="doc/TipsForPowderAutoIndexing_JP.html">Conograph を用いた粉末指数づけについて</a> (別ページに移動します) 
    <ul>
        <li>入力パラメータ表（XML ファイル）</li>
        <li>「速さ優先探索」と「メモリ使用量優先探索」の主な違い</li>
        <li>満足できる結果が得られないときに変更するパラメータ</li>
        <li>正しい解はどれですか? (figure of meritを用いた判定方法) </li>
        <li>粉末指数づけにおける解の一意性</li>
    </ul>
    <li><a href="#DifferenceFromGUI">CUI と GUI の主な違い</a> (準備中)</li>
    <li><a href="#HowtoReportBugs">バグ報告のお願い</a></li>
    <li><a href="#Citation">Conograph の引用に関して</a></li>
    <li><a href="#copyright">著作権について</a></li>
</ul>


<h3><a name="HowtoUse">Conograph CUIの使い方</a></h3>
<UL>
    <LI><b><a name="StartUpConograph">Conograph を実行する</b></a>
<ol>
<LI> 同プログラムを実行するには、以下の３つの入力ファイルを準備する必要があります。
    (付属の "sample" フォルダに例があります。)
    <UL>
    <LI> "*.inp.xml"：計算パラメータの入力ファイル (<a href="sample/sample5/Cimetidine-SR.inp.xml">例</a>),</LI>
    <LI> "cntl.inp.xml" ： "*.inp.xml"を含む入出力ファイル名を指定するファイル (<a href="sample/sample5/cntl.inp.xml">例</a>), </LI>
    <LI> IGOR テキストファイル: 粉末回折パターン (X, Y 座標と Y 座標の誤差) と以下のピークの情報を含むファイル (<a href="sample/sample5/Cimetidine-SR_pks.histogramIgor">例</a>。このファイルは付属の<a href="http://research.kek.jp/people/rtomi/InstructionsPeakSearch_JP.html">ピークサーチプログラム</a>からも出力されます)
        <ol type="a">
            <LI> ピーク位置 (2&theta;、time-of-flight、または d 値)、</LI>
            <LI> ピーク高さ (グラフ表示にのみ使用されます)、</LI>
            <LI> ピーク半値幅 (ピーク位置の誤差を推定するために使用します), </LI>
            <LI> 各ピークについて、指数づけおよび figure of merit の計算に使用しない/するを指定するための 0/1 フラグ。</LI>
        </ol>
    </LI>
    </UL>
</LI>

<LI> "sample"フォルダの中の一つのフォルダをコピーし、
コピー先のフォルダ内の二つのXMLファイルの中身とファイル名"*.inp.xml"、IGOR テキストファイルの 0/1 フラグを適宜修正してください。
ファイル名"*.inp.xml"を変更した際は、"cntl.inp"のファイル名も併せて修正する必要があります。
</LI>

<LI> コマンドプロンプト、またはお使いのOSのターミナルウィンドウを立ち上げ、
     上で変更した"cntl.inp"と同じフォルダにカレントフォルダを移動してください。

<LI> "Conograph.exe"の絶対パスをコマンドラインから入力し、Conographwを実行します。</LI>
<LI> CUI は以下のファイルを出力し、入力待ち状態に入ります:<BR>
        <ul>
            <li> 格子定数のリストを含む XML ファイル（<a href="figures/sample2.index.xml">六方晶の例</a>）。
            </li>
        </ul>
        XML ファイルの最上部には、各々の figure of merit について最も良い値を得た格子定数がブラベー格子ごとに表示されます。そのすぐ下に、
        得られた全ての格子定数の中で最も良い de Wolff figure of merit [<a href="#ref4">4</a>] の値を得た格子定数が表示されます。
     </LI>
</OL>
</LI>

<LI><b><a name="AfterExecution">実行後に格子定数とゼロ点シフトを精密化する</b></a>
<OL>
     <LI value="6"> 出力 XML ファイルの中に表示されている格子定数は、"0403003"のような数字が付いています。
        コマンドラインからその数字を入力すると、該当の格子定数とゼロ点シフトが精密化された後、以下の情報を含む IGOR テキストファイルが出力されます。(<a href="figures/sample2_lattice(Hexagonal;23.1,23.1,10.7,90,90,120;70.3).histogramIgor">例</a>):
    <ol type="a">
        <li> 入力 IGOR text file に含まれる情報のコピー、</li>
        <li> 指定した格子定数が与えるピーク位置、</li>
        <li> 指定した格子定数とブラベー格子。</li>
    </ol>
    数字は何度でも入力できます。Conograph を終了させるには "quit" と入力してください。終了時に以下のファイルが出力されます:
    <ul>
        <li> XML ファイル: 精密化された各格子定数とゼロ点シフトの情報を記載したもの (<a href="figures/sample2.index2.xml">例</a>)、
        <li> IGOR テキストファイル: 精密化の間に出力された IGOR テキストファイルを一つにまとめたもの (<a href="figures/sample2_lattices.histogramIgor">例</a>)。
    </ul>

    </LI>
</ol>
</LI>
</UL>


<h3><a name="TipsForPeakSearch">ピークサーチに関するアドバイス</a></h3> 
<p>
まずは「ピーク高さを基準に回折ピークを出来るだけ一様に拾うようにする」ことをお勧めしています。
（Conograph付属の<a href="http://sourceforge.jp/projects/conograph/releases/">ピークサーチプログラム</a>を用いて、そのようなピークサーチ結果を得るためのパラメータの設定方法は付属の取扱説明書の中で紹介しています。）
どの回折ピークを組み合わせればよいかはConographの列挙アルゴリズムによって比較的短時間の間に判定されます。根拠のある事前情報をお持ちであれば別ですが、そうではない場合、回折ピークの選別を行うことや重畳ピークを人為的に除外することで、入力情報の質を落とすことは避けた方がよいです。
</p>

<h3><a name="DifferenceFromGUI">CUI と GUI の主な違い</a> (準備中) </h3> 

<p>
ソフトウェア IGOR Pro をお持ちであれば、CUIを用いた解析もそれほど面倒ではありません。
以下では、GUIとの違いを説明します。
<ul>
<li>
GUI上ではピークサーチも実行できます。
</li>
<li>
GUI 起動時に各パラメータの推奨値がテキストボックスに自動でセットされます。
</li>

<li>
GUI起動時には
recommended values are automatically set in the text boxes for respective input parameters.  
</li>

<li>
GUIでは、粉末回折パターンと各格子定数に対して計算されるピーク位置の比較を、より容易に高い自由度の下で行うことが出来ます。
</li>

<li>
GUIでは、de Wolff figure of merit 以外の基準を用いて解のソートを行うことが出来ます。
</li>

<li>
CUIでは一連の手続きとして実行している以下の機能を、
GUIでは独立に実行することが出来ますので、計算のやり直しに要するコストが小さくなります。>

    <ol type = "a">
	<li> 指数づけ実行前に行う、reflection pair method [<a href="#ref1">1</a>]によるゼロ点シフト &Delta;2&theta; の推定
	     (CUI使用時は、解析初期に画面上にいくつかの候補値が出力されます。)
        </li>
	<li> 解のソートに使用する de Wolff figure of merit M<Sub>n</Sub>の計算に用いる n の推定
             (dominant zone と呼ばれる問題が生じている場合、n = 20以上の値を使用する必要があります。)
        </li>
    </ol>

CUIでは、上記の推定値を使用する際、プログラムを一度終了させる必要があります。
特に a. について、
正しい値が &Delta;2&theta; = 0.195&deg; と非常に大きなケースでも、
Conograph からは十分な結果が得られており、
多くのケースで &Delta;2&theta; = 0 を使用し、指数づけ後の精密化を行えば十分と考えられることから、CUIはこのような簡易な実装になっています。
</li>
</ul>

<p>
図2 は CUI のフローチャートです:<BR>
<div align="center">
   <p class="image"><a href="figures/flowchart_JP.png" target="_self"><img src="figures/flowchart_JP.png" width="480" height="360" alt="Figure 2" border="0"></a></p>
   <p class="caption ">図2: CUIのフローチャート<BR>
     (クリックすると大きな図が見られます。)</p>
</div>
</p>



<h3><a name="HowtoReportBugs">バグ報告のお願い</a></h3>
<p>
コード改善のために、疑わしい事例を見つけられましたら、以下のアドレスまでご連絡頂けると助かります。<BR>
その際、"LOG_CONOGRAPH.txt"を含む全ての入出力ファイルをご添付ください。
<UL>
<LI> conograph-bugs (at) ml.post.kek.jp
</UL>
</p>


<h3><a name="Citation">Conograph の引用に関して</a></h3>
<p>
Conograph を用いて得られた研究成果を発表される際には、以下の文献を引用して頂けるようお願いいたします（Conographに関する原著論文は現在査読中です (2013/2/24)）。
Conograph の継続開発のための予算獲得にご協力ください。
<UL>
<LI> R. Oishi, M. Yonemura, T. Ishigaki, A. Hoshikawa, K. Mori, T. Morishima, S. Torii, T. Kamiyama,<BR>
"New approach to indexing method of powder diffraction patterns using topographs",
Zeitschrift f&#252;r Kristallographie Supplements 30 (2009), pp.15--20.
</LI>
</UL>
</p>


<h3><a name="copyright">著作権について</a></h3>
<p>
本プログラムのソースコードは、MITライセンスの下、web上(Conographプロジェクトの<a href="http://sourceforge.jp/projects/conograph/scm/svn/tree/head">リポジトリリスト<a/>)で公開しています（2013/3/2現在）。
</p>


<h2><a name="Acknowledgments">謝辞</a></h2>
<p>
Conograph projectのために粉末回折データを提供頂いた方々に感謝します。
</p>

<h2><a name="References">References</a></h2>
<p>
<OL>
<a name="ref1"><LI></a>
C. Dong, F. Wu, H. Chen, <BR>
"Correction of zero shift in powder diffraction patterns using the reflection-pair method", J. Appl. Cryst., 32, pp. 850-853 (1999).</LI>

<a name="ref2"><LI></a>
R. Oishi-Tomiyasu, <BR>
"Distribution rules of crystallographic systematic absences on the Conway topograph and their application to powder auto-indexing", <a href="http://arxiv.org/abs/1211.3926">preprint</a>.
</LI>

<a name="ref3"><LI></a>
R. Oishi-Tomiyasu, <BR>
"Rapid Bravais-lattice determination algorithm for lattice constants containing large observation errors", Acta Cryst. A, 68, pp. 525-535 (2012).
</LI>

<a name="ref4"><LI></a>
P. M. de Wolff, <BR>
"A simplified criterion for the reliability of a powder pattern indexing", J. Appl. Cryst., 1, pp. 108-113 (1968).</LI>

</OL>
</p>

<A HREF="#">［Back to top]</A>
</body>

